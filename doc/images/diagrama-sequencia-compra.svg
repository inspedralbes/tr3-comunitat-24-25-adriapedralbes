<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1000" height="700" viewBox="0 0 1000 700">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#000" />
    </marker>
  </defs>
  <rect width="1000" height="700" fill="#ffffff" />
  
  <!-- Títol -->
  <text x="500" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle">Diagrama de Seqüència - Procés de Compra</text>
  
  <!-- Participants -->
  <rect x="70" y="60" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="120" y="85" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Usuari</text>
  
  <rect x="270" y="60" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="320" y="85" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Frontend</text>
  
  <rect x="470" y="60" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="520" y="85" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Backend</text>
  
  <rect x="670" y="60" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="720" y="85" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">BD</text>
  
  <rect x="870" y="60" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="920" y="85" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Stripe</text>
  
  <!-- Línies de vida -->
  <line x1="120" y1="100" x2="120" y2="650" stroke="#000" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="320" y1="100" x2="320" y2="650" stroke="#000" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="520" y1="100" x2="520" y2="650" stroke="#000" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="720" y1="100" x2="720" y2="650" stroke="#000" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="920" y1="100" x2="920" y2="650" stroke="#000" stroke-width="1" stroke-dasharray="5,5" />
  
  <!-- Activacions -->
  <rect x="115" y="130" width="10" height="500" fill="#e9ecef" stroke="#000" stroke-width="1" />
  <rect x="315" y="150" width="10" height="460" fill="#e9ecef" stroke="#000" stroke-width="1" />
  <rect x="515" y="170" width="10" height="420" fill="#e9ecef" stroke="#000" stroke-width="1" />
  <rect x="715" y="190" width="10" height="60" fill="#e9ecef" stroke="#000" stroke-width="1" />
  <rect x="715" y="430" width="10" height="60" fill="#e9ecef" stroke="#000" stroke-width="1" />
  <rect x="915" y="310" width="10" height="100" fill="#e9ecef" stroke="#000" stroke-width="1" />
  
  <!-- Missatges -->
  <!-- 1. Seleccionar pla -->
  <line x1="125" y1="150" x2="315" y2="150" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="220" y="140" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">1. Selecciona pla</text>
  
  <!-- 2. Consultar detalls del pla -->
  <line x1="325" y1="170" x2="515" y2="170" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="420" y="160" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">2. Consulta detalls del pla</text>
  
  <!-- 3. Consultar BD -->
  <line x1="525" y1="190" x2="715" y2="190" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="620" y="180" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">3. Consulta el pla</text>
  
  <!-- 4. Retornar info -->
  <line x1="715" y1="250" x2="525" y2="250" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="620" y="240" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">4. Retorna detalls del pla</text>
  
  <!-- 5. Retornar info al frontend -->
  <line x1="515" y1="270" x2="325" y2="270" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="420" y="260" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">5. Retorna detalls del pla</text>
  
  <!-- 6. Mostrar formulari -->
  <line x1="315" y1="290" x2="125" y2="290" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="220" y="280" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">6. Mostra formulari de pagament</text>
  
  <!-- 7. Enviar dades pagament -->
  <line x1="125" y1="310" x2="315" y2="310" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="220" y="300" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">7. Envia dades de pagament</text>
  
  <!-- 8. Enviar petició subscripció -->
  <line x1="325" y1="330" x2="515" y2="330" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="420" y="320" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">8. Envia petició de subscripció</text>
  
  <!-- 9. Crear intent pagament -->
  <line x1="525" y1="350" x2="915" y2="350" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="720" y="340" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">9. Crea intent de pagament</text>
  
  <!-- 10. Retornar resultat Stripe -->
  <line x1="915" y1="410" x2="525" y2="410" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="720" y="400" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">10. Retorna resultat</text>
  
  <!-- 11. Guardar subscripció -->
  <line x1="525" y1="430" x2="715" y2="430" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="620" y="420" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">11. Guarda subscripció</text>
  
  <!-- 12. Confirmar subscripció -->
  <line x1="715" y1="490" x2="525" y2="490" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="620" y="480" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">12. Confirma subscripció</text>
  
  <!-- 13. Retornar resultat -->
  <line x1="515" y1="510" x2="325" y2="510" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="420" y="500" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">13. Retorna resultat</text>
  
  <!-- 14. Mostrar confirmació -->
  <line x1="315" y1="530" x2="125" y2="530" stroke="#000" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="220" y="520" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">14. Mostra confirmació</text>
  
  <!-- Notes -->
  <rect x="770" y="290" width="180" height="40" fill="#ffffcc" stroke="#000" stroke-width="1" />
  <text x="860" y="310" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">El formulari utilitza</text>
  <text x="860" y="325" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">Stripe Elements</text>
  <line x1="770" y1="310" x2="325" y2="290" stroke="#000" stroke-width="1" stroke-dasharray="3,3" />
  
  <rect x="770" y="370" width="180" height="40" fill="#ffffcc" stroke="#000" stroke-width="1" />
  <text x="860" y="390" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">Stripe processa el pagament</text>
  <text x="860" y="405" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">i verifica la targeta</text>
  <line x1="770" y1="390" x2="915" y2="380" stroke="#000" stroke-width="1" stroke-dasharray="3,3" />
  
  <!-- Participants (repetits a sota) -->
  <rect x="70" y="650" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="120" y="675" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Usuari</text>
  
  <rect x="270" y="650" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="320" y="675" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Frontend</text>
  
  <rect x="470" y="650" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="520" y="675" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Backend</text>
  
  <rect x="670" y="650" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="720" y="675" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">BD</text>
  
  <rect x="870" y="650" width="100" height="40" rx="5" fill="#f8f9fa" stroke="#000" stroke-width="2" />
  <text x="920" y="675" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Stripe</text>
</svg>